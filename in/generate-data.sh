#!/usr/bin/env bash
echo "[INFO] borough shapefile exists in the repo"
echo "[STEP] convert borough shapefile to in/borough.sql"
shp2pgsql -s 3857:2263 -c in/Borough.shp borough > in/borough.sql
echo "[STEP] download filtered 2020 census ZCTAs to geojson"
curl "https://tigerweb.geo.census.gov/arcgis/rest/services/TIGERweb/tigerWMS_Census2020/MapServer/84/query?where=zcta5+in++%28%2711559%27%2C%2711581%27%2C%2711426%27%2C%2711001%27%2C%2711003%27%2C%2711580%27%2C%2711004%27%2C%2711005%27%2C%2711042%27%2C%2711040%27%2C%2711021%27%2C%2711020%27%2C%2711355%27%2C%2711367%27%2C%2711420%27%2C%2711693%27%2C%2711430%27%2C%2711435%27%2C%2711365%27%2C%2711432%27%2C%2711366%27%2C%2711358%27%2C%2711436%27%2C%2711692%27%2C%2711433%27%2C%2711434%27%2C%2711451%27%2C%2711439%27%2C%2711361%27%2C%2711691%27%2C%2711423%27%2C%2711364%27%2C%2711412%27%2C%2711096%27%2C%2711413%27%2C%2711427%27%2C%2711362%27%2C%2711428%27%2C%2711429%27%2C%2711422%27%2C%2711411%27%2C%2710463%27%2C%2710457%27%2C%2710459%27%2C%2710474%27%2C%2711370%27%2C%2710458%27%2C%2710460%27%2C%2711371%27%2C%2710467%27%2C%2710472%27%2C%2710473%27%2C%2710470%27%2C%2710462%27%2C%2710466%27%2C%2710469%27%2C%2710461%27%2C%2711356%27%2C%2710550%27%2C%2710465%27%2C%2710475%27%2C%2711357%27%2C%2710803%27%2C%2710464%27%2C%2711360%27%2C%2711359%27%2C%2711363%27%2C%2711249%27%2C%2711211%27%2C%2711415%27%2C%2711379%27%2C%2711375%27%2C%2711374%27%2C%2711424%27%2C%2711378%27%2C%2711222%27%2C%2711101%27%2C%2711373%27%2C%2711377%27%2C%2711368%27%2C%2711104%27%2C%2711109%27%2C%2711372%27%2C%2710017%27%2C%2710044%27%2C%2710022%27%2C%2711106%27%2C%2711103%27%2C%2711354%27%2C%2710171%27%2C%2711369%27%2C%2710154%27%2C%2710152%27%2C%2710065%27%2C%2710153%27%2C%2711102%27%2C%2710021%27%2C%2710162%27%2C%2711697%27%2C%2711694%27%2C%2711235%27%2C%2711234%27%2C%2711223%27%2C%2711229%27%2C%2711230%27%2C%2711210%27%2C%2711236%27%2C%2711239%27%2C%2711226%27%2C%2711203%27%2C%2711414%27%2C%2711207%27%2C%2711238%27%2C%2711212%27%2C%2711225%27%2C%2711208%27%2C%2711213%27%2C%2711233%27%2C%2711417%27%2C%2711216%27%2C%2711416%27%2C%2711419%27%2C%2711385%27%2C%2711421%27%2C%2711221%27%2C%2711205%27%2C%2711418%27%2C%2711237%27%2C%2711206%27%2C%2710024%27%2C%2710025%27%2C%2710027%27%2C%2710075%27%2C%2710115%27%2C%2710029%27%2C%2710028%27%2C%2710026%27%2C%2710128%27%2C%2710031%27%2C%2710032%27%2C%2710030%27%2C%2710035%27%2C%2710034%27%2C%2710033%27%2C%2710039%27%2C%2710037%27%2C%2710040%27%2C%2710452%27%2C%2710451%27%2C%2710454%27%2C%2710453%27%2C%2711105%27%2C%2710471%27%2C%2710455%27%2C%2710456%27%2C%2710468%27%2C%2710704%27%2C%2710705%27%2C%2710001%27%2C%2710018%27%2C%2710012%27%2C%2710036%27%2C%2710199%27%2C%2710003%27%2C%2710019%27%2C%2710023%27%2C%2710119%27%2C%2710010%27%2C%2710069%27%2C%2710009%27%2C%2710016%27%2C%2710110%27%2C%2710020%27%2C%2710112%27%2C%2710111%27%2C%2710173%27%2C%2710165%27%2C%2710103%27%2C%2710168%27%2C%2710170%27%2C%2710169%27%2C%2710177%27%2C%2710174%27%2C%2710167%27%2C%2710172%27%2C%2710301%27%2C%2707305%27%2C%2710305%27%2C%2710004%27%2C%2711209%27%2C%2711220%27%2C%2711228%27%2C%2711232%27%2C%2711231%27%2C%2710280%27%2C%2710282%27%2C%2710013%27%2C%2710006%27%2C%2711214%27%2C%2710007%27%2C%2711224%27%2C%2711219%27%2C%2710005%27%2C%2710271%27%2C%2710038%27%2C%2710279%27%2C%2711201%27%2C%2710278%27%2C%2711215%27%2C%2711204%27%2C%2710002%27%2C%2711218%27%2C%2711217%27%2C%2710014%27%2C%2710011%27%2C%2707206%27%2C%2710314%27%2C%2710303%27%2C%2710311%27%2C%2710306%27%2C%2710308%27%2C%2707002%27%2C%2710302%27%2C%2710310%27%2C%2710304%27%2C%2710307%27%2C%2710309%27%2C%2710312%27%29&text=&objectIds=&time=&timeRelation=esriTimeRelationOverlaps&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&distance=&units=esriSRUnit_Foot&relationParam=&outFields=&returnGeometry=true&returnTrueCurves=false&maxAllowableOffset=&geometryPrecision=&outSR=&havingClause=&returnIdsOnly=false&returnCountOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&gdbVersion=&historicMoment=&returnDistinctValues=false&resultOffset=&resultRecordCount=&returnExtentOnly=false&sqlFormat=none&datumTransformation=&parameterValues=&rangeValues=&quantizationParameters=&featureEncoding=esriDefault&f=geojson" -o zcta.geojson
echo "[STEP] convert zcta shapefile to in/zcta.sql"
shp2pgsql -s 2263 -c in/zcta.shp zcta > in/zcta.sql
echo "[DONE] generate-data complete"